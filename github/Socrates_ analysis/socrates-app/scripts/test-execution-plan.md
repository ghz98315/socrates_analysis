# P0 任务测试执行计划

> 执行日期: 2026-02-14
> 目标: 验证核心功能正常工作

---

## 测试环境准备

### 前置条件
- [x] 数据库迁移已完成
- [x] 开发服务器已就绪
- [x] 环境变量已配置

### 需要的测试账号
| 类型 | 邮箱/手机号 | 密码 | 用途 |
|------|------------|------|------|
| 家长 | test-parent@example.com | test123456 | P0-2, P0-4 |
| 学生 | test-student@example.com | test123456 | P0-3 |

---

## P0-2: 测试家长登录和 Dashboard

### TC-01: 家长登录流程

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | 访问 `/login` | 显示登录页面 | |
| 2 | 输入家长邮箱和密码 | 表单可提交 | |
| 3 | 点击"登录"按钮 | 跳转到 `/select-profile` | |
| 4 | 检查 URL 变化 | 应该跳转成功 | |

### TC-02: 家长角色选择

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | 在 `/select-profile` 选择 "Parent" | 跳转到 `/dashboard` | |
| 2 | 检查 profile.role | 应更新为 'parent' | |

### TC-03: 家长 Dashboard 加载

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | Dashboard 页面加载 | 显示学生选择界面 | |
| 2 | 检查学生列表 API | `/api/students` 返回数据 | |
| 3 | 检查"添加学生"按钮 | 按钮可点击 | |

---

## P0-3: 测试学生错题上传和保存

### TC-04: 学生登录流程

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | 访问 `/login` | 显示登录页面 | |
| 2 | 输入学生邮箱和密码 | 表单可提交 | |
| 3 | 点击"登录"按钮 | 跳转到 `/select-profile` | |
| 4 | 选择 "Junior" 或 "Senior" 角色 | 跳转到 `/workbench` | |

### TC-05: 学生工作台加载

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | Workbench 页面加载 | 显示上传界面 | |
| 2 | 检查学习会话 | 自动开始学习计时 | |
| 3 | 检查主题显示 | Junior/Senior 主题正确 | |

### TC-06: 错题上传和 OCR

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | 点击上传区域 | 打开文件选择器 | |
| 2 | 选择一张图片 | 图片预览显示 | |
| 3 | OCR 自动处理 | 显示提取的文字 | |

### TC-07: 错题会话保存

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | 点击"确认"按钮 | 创建 error_session | |
| 2 | 检查 API 调用 | `/api/error-session` 成功 | |
| 3 | 检查数据库 | error_sessions 表有记录 | |

---

## P0-4: 测试家长添加学生功能

### TC-08: 添加学生表单

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | 家长登录后点击"添加学生" | 显示模态框 | |
| 2 | 检查表单字段 | 姓名、邮箱、密码、年级都显示 | |
| 3 | 填写表单 | 所有字段可填写 | |

### TC-09: 提交添加学生

| 步骤 | 操作 | 预期结果 | 实际结果 |
|------|------|---------|---------|
| 1 | 填写完整信息后提交 | API 调用 `/api/students/add` | |
| 2 | 检查响应 | 返回成功消息 | |
| 3 | 检查学生列表 | 新学生出现在列表中 | |

### TC-10: 学生数据验证

```sql
-- 验证新创建的学生账号
SELECT
  p.id,
  p.display_name,
  p.email,
  p.phone,
  p.role,
  p.parent_id,
  p.grade_level,
  p.created_at
FROM profiles p
WHERE p.role = 'student'
ORDER BY p.created_at DESC
LIMIT 5;
```

**检查项**:
- [ ] 新学生 role = 'student'
- [ ] parent_id 指向正确的家长
- [ ] phone 字段已保存
- [ ] grade_level 已保存

---

## 执行检查清单

### P0-2: 家长登录和 Dashboard
- [ ] TC-01: 家长登录流程
- [ ] TC-02: 家长角色选择
- [ ] TC-03: 家长 Dashboard 加载

### P0-3: 学生错题上传和保存
- [ ] TC-04: 学生登录流程
- [ ] TC-05: 学生工作台加载
- [ ] TC-06: 错题上传和 OCR
- [ ] TC-07: 错题会话保存

### P0-4: 家长添加学生功能
- [ ] TC-08: 添加学生表单
- [ ] TC-09: 提交添加学生
- [ ] TC-10: 学生数据验证

---

## 测试执行记录

### 执行人: ____________  执行时间: __________

### 测试结果

| TC | 结果 | 备注 |
|----|------|------|
| TC-01 | | |
| TC-02 | | |
| TC-03 | | |
| TC-04 | | |
| TC-05 | | |
| TC-06 | | |
| TC-07 | | |
| TC-08 | | |
| TC-09 | | |
| TC-10 | | |

---

## 发现的问题

| Bug ID | 描述 | 严重程度 | 状态 |
|--------|------|----------|------|
| | | | |

---

## 下一步

测试完成后：
- [ ] 修复所有发现的 Bug
- [ ] 更新测试报告
- [ ] 提交代码变更
- [ ] 开始 P1 任务
